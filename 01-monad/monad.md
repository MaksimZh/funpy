# 1. Избавляемся от хранения промежуточных результатов
При расчётах с использованием итерационных методов часто встречается
код такого вида:
```Python
f0 = calc_f0(...)
for n in range(max_iterations):
    f1 = calc_f(f0, ...)
    if calc_delta(f1, f0) < f_tolerance:
        break
    f0 = f1
```
Циклы с мутабельными состояниями можно заменить рекурсией.
При этом рекурсивную функцию имеет смысл генерировать с помощью функции
высшего порядка:
```Python
def iterations_func(calc_next, converged, max_iterations):

    def iterate(f, n):
        # сдаёмся?
        if n >= max_iterations:
            return f
        f1 = calc_next(f)
        # нашли решение?
        if converged(f1, f):
            return f1
        # хвостовая рекурсия!
        return iterate(f1, n + 1)

    return lambda f: iterate(f, 0)
```
Тогда вместо цикла можно написать:
```Python
calc = iterations_func(
    lambda f: calc_f(f, ...),
    lambda f1, f: calc_delta(f1, f) < f_tolerance,
    max_iterations)
f0 = calc_f0(...)
f = calc(f0)
```


# 2. Архитектура без явных промежуточных результатов
Если цепочка вычислений фиксирована, то dataflow подход вообще не требует
переменных.
Просто нужно связать выходы одних процедур с входами других и обеспечить
передачу данных между ними.

В идеале можно задавать такой граф процедур в декларативном виде,
и на его основе генерировать разный код под конкретные нужды:
от вызовов функций в одном потоке до системы акторов,
с ленивыми или жадными вычислениями и т.п.

Другой вариант - реактивное программирование.
Потоки событий и данных в программе
присутствует в виде последовательностей.
Все операции производятся с этими последовательностями
и записываются декларативно.
Вычисления производятся ленивым образом.

Вот пример обработки двойного щелчка мышью:
```Python
double_click_sequence =
    filter( # оставляем только двойные щелчки
        lambda g: len(g) == 2,
        group_by_delay( # группируем щелчки по времени задержки между ними
            max_delay,
            filter( # выбираем только щелчки левой кнопкой мыши
                lambda e: e.kind == LEFT_MOUSE_CLICK,
                event_sequence))
```
